<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>HDF5 Extras: Base Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HDF5 Extras
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Convenience Functions for using HDF5 Better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Base Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a name="%42ase%20%4cibrary"></a></p>
<p>The library is implemented in several layers, as described in the previous chapter. The base library is used by all the others, containing functions to deal with the following major functions: </p><ul>
<li>Safe Strings </li>
<li>malloc/free</li>
</ul>
<p>These are described in the following sections.</p>
<h1><a class="anchor" id="base_safe_strings"></a>
Safe Strings</h1>
<p><a name="%53afe%20%53trings"></a></p>
<p>Strings are notorious for causing trouble in C code. Instead of using them, we choose to use a library that implements a safer string. This library is called the Better String Library, and is written by Paul Hsieh. It is available from: <a href="http://bstring.sourceforge.net">http://bstring.sourceforge.net</a>. The basic idea is to have the string and metadata about the string in a <code>struct</code>, and the <code>struct</code> is used in the code, not the string, as shown in the code fragment below: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structtagbstring.html">tagbstring</a> {</div>
<div class="line">    <span class="keywordtype">int</span> mlen;</div>
<div class="line">    <span class="keywordtype">int</span> slen;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * data;</div>
<div class="line">};</div>
</div><!-- fragment --><p> Note that the string part of this <code>struct</code> is named <code>data</code>, while the length of the valid data in the string is stored in <code>slen</code>, and the number of bytes allocated to data is stored in <code>mlen</code>. As needed, the string part of this struct is allocated, reallocated and deallocated, so that there are fewer errors by the programmer. Note that a <code>bstring</code> must be initialized before most of the <code>bstring</code> functions can operate on it sensibly. The typical usage of this new datatype is supported by many functions, a few of which are shown below:</p>
<ul>
<li>declaring it: <code>bstring str1</code> </li>
<li>declaring and allocating it: <code>bstring str1 = bfromcstr("")</code> </li>
<li>get the c-string from the bstring: <code>bdata(bstring b)</code> </li>
<li>assign a c-string to a bstring: <code>bassigncstr(b, "")</code> </li>
<li>sprintf: <code>bassignformat(b, "format", variables, ...)</code> </li>
<li>refer to a character in the string: <code>bchar(b, index)</code> </li>
<li>copy a bstring to another bstring, which may not be initialized yet: <code>name = bstrcpy(filename)</code> </li>
<li>deallocate: <code>bdestroy(b)</code> </li>
<li>strlen: <code>blength(b)</code> </li>
<li>strcpy: <code>bassign(a,b)</code> </li>
<li>strstr: <code>binstr(b, pos,  c)</code> </li>
<li>strcat: <code>bconcat(b, c)</code> </li>
<li>constant strings: <code>bsstatic("blah")</code> </li>
<li>reading from a file:</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="structtagbstring.html">bstring</a> theline = bfromcstr(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structbStream.html">bStream</a> * bstream;</div>
<div class="line">FILE *fp;</div>
<div class="line">fp =fopen(<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;access&quot;</span>);</div>
<div class="line">bstream = bsopen ((bNread) fread, fp);</div>
<div class="line">bsread(theline,bstream,10);</div>
<div class="line">bsclose(bstream);</div>
<div class="line">fclose(fp);</div>
</div><!-- fragment --><h1><a class="anchor" id="base_mallocfree"></a>
Malloc/Free</h1>
<p><a name="%47%4dalloc"></a> <a name="%47%46ree"></a></p>
<p>We have an implementation of malloc/free called GMalloc/GFree that is used everywhere in our library. This currently is a thin layer on top of the C standard malloc/free. THe basic idea here is to not free null pointers, and to have stubs that can be rewritten later if needed, without having to rewrite all of our existing code.</p>
<p><a name="%42ase%20%4cibrary%20%4dacros"></a> Other things that are available in the <code>base.h</code> file are: definitions for <code>TRUE</code> and <code>FALSE</code>, macros <code>MIN</code>, <code>MAX</code>, <code>ABS</code>, bstring-comparisons: <code>EQUAL</code>, and <code>EQUALN</code>, block-copy macros: <code>ByteCopy</code> and <code>BstringCopy</code>, and a few other constants and typedefs.</p>
<p>next: <a class="el" href="hdf_library.html">HDF5 Abstraction Library</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 16 2016 18:04:14 for HDF5 Extras by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
